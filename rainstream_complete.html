<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>RAINSTREAM v2.1.0 - PROVEN</title><style>*{margin:0;padding:0;box-sizing:border-box}html,body{width:100%;height:100%;overflow:hidden;background:#0a0e27}body{font-family:"Courier New",monospace;color:#00d4ff;display:flex;flex-direction:column}.header{background:linear-gradient(90deg,#00d4ff 0%,#ffed4e 100%);color:#000;padding:8px;text-align:center;font-weight:bold;font-size:1.1em;text-shadow:1px 1px rgba(0,0,0,0.3)}.container{display:flex;flex:1;gap:8px;padding:8px;overflow:hidden}.sidebar{display:flex;flex-direction:column;gap:8px;width:180px;flex-shrink:0}.panel{background:#1a1f3a;border:2px solid #00d4ff;border-radius:6px;padding:10px;overflow-y:auto}.panel h3{color:#ffed4e;font-size:0.85em;margin-bottom:6px;border-bottom:1px solid #00d4ff;padding-bottom:4px}.player-stat{background:rgba(0,212,255,0.08);padding:6px;border-radius:4px;margin:4px 0;border-left:3px solid #00d4ff}.player-name{color:#ffed4e;font-weight:bold;font-size:0.8em}.score-large{color:#00ff88;font-size:1.8em;font-weight:bold;line-height:1}.stat-row{display:flex;justify-content:space-between;font-size:0.7em;color:#00d4ff;margin:2px 0}.timer-display{background:rgba(255,0,0,0.2);border:2px solid #ff4444;border-radius:6px;padding:8px;text-align:center;font-size:2.5em;color:#ff4444;font-weight:bold}.game-area{flex:1;display:flex;flex-direction:column;gap:8px;overflow:hidden}.video-container{flex:1;position:relative;background:#000;border:2px solid #00d4ff;border-radius:6px;overflow:hidden}.video-container video{width:100%;height:100%;object-fit:contain}.canvas-overlay{position:absolute;top:0;left:0;z-index:10}.game-controls{background:#1a1f3a;border:2px solid #00d4ff;border-radius:6px;padding:6px;display:flex;gap:4px;flex-wrap:wrap;align-items:center;overflow:hidden;font-size:0.75em}select{background:#0a0e27;color:#ffed4e;border:1px solid #00d4ff;padding:2px;border-radius:2px;font-size:0.75em}button{background:#00d4ff;color:#000;padding:4px 8px;border:none;border-radius:4px;cursor:pointer;font-weight:bold;font-size:0.7em;white-space:nowrap}button:hover{background:#00ffff}button.active{background:#ff8800}.label-select{color:#00d4ff;display:flex;gap:3px;align-items:center;font-size:0.7em}.perf-monitor{background:rgba(0,212,255,0.05);border-left:3px solid #00ff00;padding:4px 6px;border-radius:2px;font-size:0.65em;color:#00ff00;margin:2px 0}.help-text{position:absolute;bottom:10px;left:10px;background:rgba(0,0,0,0.85);border:1px solid #00d4ff;padding:8px;font-size:0.7em;color:#00d4ff;border-radius:4px;z-index:5;max-width:150px;line-height:1.4}</style></head><body><div class="header">‚ö° RAINSTREAM v2.1.0 ‚ö° | Pattern Recognition Gaming</div><div class="container"><div class="sidebar"><div class="panel" style="flex:0 0 auto"><h3>‚è± TIMER</h3><div class="timer-display" id="timer">30</div></div><div class="panel" style="flex:1;overflow-y:auto"><h3>üë§ PLAYERS</h3><div class="player-stat"><div class="player-name">YOU</div><div class="score-large" id="p1-score">0</div><div class="stat-row"><span>Hits</span><span id="p1-hits">0</span></div><div class="stat-row"><span>Marks</span><span id="p1-marks">0</span></div></div><div class="player-stat" style="border-left-color:#ffed4e"><div class="player-name" style="color:#ffed4e">CPU</div><div class="score-large" style="color:#ffaa00" id="p2-score">0</div><div class="stat-row"><span>Hits</span><span id="p2-hits">0</span></div></div><div class="player-stat" style="border-left-color:#ff6666"><div class="player-name" style="color:#ff6666">AI</div><div class="score-large" style="color:#ff6666" id="ai-score">0</div><div class="stat-row"><span>Hits</span><span id="ai-hits">0</span></div></div></div><div class="panel" style="flex:0 0 auto"><h3>‚öôÔ∏è PERF</h3><div class="perf-monitor" id="fps">FPS: 0</div><div class="perf-monitor" id="detect-time">Detect: 0ms</div><div class="perf-monitor" id="drops">Drops: 0</div></div></div><div class="game-area"><div class="video-container"><video id="video" muted playsinline></video><canvas id="canvas" class="canvas-overlay"></canvas><div class="help-text">üñä TAP: Mark<br>üñä DRAG: Stream<br>üëÅ AI (3s): Show detection</div></div><div class="game-controls"><label class="label-select"><span>Video:</span><select id="video-select" onchange="loadVideo()"><option value="">Select</option><option value="20251224_221145.mp4">Stream 1</option><option value="20251224_221256.mp4">Stream 2</option></select></label><button id="play-btn" onclick="play()">‚ñ∂ PLAY</button><button onclick="pause()">‚è∏ PAUSE</button><button onclick="reset()">üîÑ RESET</button><label class="label-select"><span>AI:</span><select id="difficulty"><option value="easy">Easy</option><option value="medium" selected>Medium</option><option value="hard">Hard</option><option value="expert">Expert</option></select></label><button id="ai-btn" onclick="showAI()" style="background:#ff8800">üëÅ AI (3s)</button></div></div></div><script>const GAME_TIME=30000;const TAP_THRESHOLD=250;const TAP_DISTANCE=10;const DETECT_INTERVAL=4;const BRIGHTNESS_THRESHOLD=120;const state={gameRunning:false,gamePaused:false,gameStartTime:0,timeRemaining:GAME_TIME,detecting:true,difficulty:'medium',showAI:false,aiUntil:0,p1:{score:0,marks:[],hits:0},p2:{score:0,hits:0},ai:{score:0,hits:0},drops:[],fps:0,detectTime:0,frameCount:0,lastFpsTime:Date.now(),detectFrame:0,lastFrameTime:Date.now()};const video=document.getElementById('video');const canvas=document.getElementById('canvas');const ctx=canvas.getContext('2d');let drawing=false,drawPath={points:[]},tapX=0,tapY=0,tapTime=0;function initCanvas(){canvas.width=canvas.parentElement.offsetWidth;canvas.height=canvas.parentElement.offsetHeight}window.addEventListener('load',initCanvas);window.addEventListener('resize',initCanvas);function loadVideo(){video.src=document.getElementById('video-select').value}function play(){if(state.gameRunning&&state.gamePaused){state.gamePaused=false;video.play();document.getElementById('play-btn').textContent='‚è∏ PAUSE';gameLoop();return}if(state.gameRunning)return;reset();state.gameRunning=true;state.gameStartTime=Date.now();video.play();document.getElementById('play-btn').textContent='‚è∏ PAUSE';gameLoop()}function pause(){state.gamePaused=true;video.pause();document.getElementById('play-btn').textContent='‚ñ∂ PLAY'}function reset(){state.gameRunning=false;state.gamePaused=false;state.timeRemaining=GAME_TIME;state.gameStartTime=0;state.p1={score:0,marks:[],hits:0};state.p2={score:0,hits:0};state.ai={score:0,hits:0};state.drops=[];video.currentTime=0;video.pause();ctx.clearRect(0,0,canvas.width,canvas.height);document.getElementById('play-btn').textContent='‚ñ∂ PLAY';updateUI()}function showAI(){if(!state.gameRunning)return;state.showAI=true;state.aiUntil=Date.now()+3000}function findDrops(imgData){const data=imgData.data,w=imgData.width;const pts=[];for(let i=0;i<data.length;i+=4){const bright=(data[i]+data[i+1]+data[i+2])/3;if(bright>BRIGHTNESS_THRESHOLD){const idx=i/4;pts.push({x:idx%w,y:Math.floor(idx/w),b:bright})}}return cluster(pts)}function cluster(pts){if(pts.length<3)return[];const clusters=[],used=new Set();for(let i=0;i<pts.length;i++){if(used.has(i))continue;const group=[pts[i]];used.add(i);for(let j=i+1;j<pts.length;j++){if(used.has(j))continue;const d=Math.hypot(pts[i].x-pts[j].x,pts[i].y-pts[j].y);if(d<25){group.push(pts[j]);used.add(j)}}if(group.length>=2){const cx=group.reduce((a,p)=>a+p.x,0)/group.length;const cy=group.reduce((a,p)=>a+p.y,0)/group.length;const cb=group.reduce((a,p)=>a+p.b,0)/group.length;const r=Math.sqrt(group.length/Math.PI)+2;const conf=Math.min(1,(cb-BRIGHTNESS_THRESHOLD)/135);clusters.push({x:cx,y:cy,r,conf,hit:false})}}return clusters}function draw(){ctx.clearRect(0,0,canvas.width,canvas.height);const showAI=state.showAI&&Date.now()<state.aiUntil;if(state.detecting&&showAI&&state.drops.length){state.drops.forEach(d=>{ctx.strokeStyle=`rgba(255,237,74,${d.conf})`;ctx.lineWidth=2;ctx.beginPath();ctx.arc(d.x,d.y,d.r,0,2*Math.PI);ctx.stroke();ctx.fillStyle='rgba(255,237,74,0.1)';ctx.fill()})}state.p1.marks.forEach(m=>{ctx.strokeStyle='#00ff88';ctx.lineWidth=2;ctx.beginPath();ctx.arc(m.x,m.y,6,0,2*Math.PI);ctx.stroke()});if(drawing&&drawPath.points.length){ctx.strokeStyle='rgba(0,255,136,0.5)';ctx.lineWidth=2.5;ctx.lineCap='round';ctx.lineJoin='round';ctx.beginPath();ctx.moveTo(drawPath.points[0].x,drawPath.points[0].y);for(let i=1;i<drawPath.points.length;i++)ctx.lineTo(drawPath.points[i].x,drawPath.points[i].y);ctx.stroke()}}canvas.addEventListener('mousedown',e=>{if(!state.gameRunning||state.gamePaused||e.button!==0)return;const r=canvas.getBoundingClientRect();tapX=e.clientX-r.left;tapY=e.clientY-r.top;tapTime=Date.now();drawing=true;drawPath={points:[{x:tapX,y:tapY}]}});canvas.addEventListener('mousemove',e=>{if(!drawing)return;const r=canvas.getBoundingClientRect();const nx=e.clientX-r.left,ny=e.clientY-r.top;const last=drawPath.points[drawPath.points.length-1];if(Math.hypot(nx-last.x,ny-last.y)>2)drawPath.points.push({x:nx,y:ny});draw()});canvas.addEventListener('mouseup',e=>{if(!drawing)return;drawing=false;const dur=Date.now()-tapTime;const last=drawPath.points[drawPath.points.length-1];const dist=Math.hypot(tapX-last.x,tapY-last.y);if(dur<TAP_THRESHOLD&&dist<TAP_DISTANCE){state.p1.marks.push({x:tapX,y:tapY})}else if(drawPath.points.length>5){state.p1.marks.push({x:tapX,y:tapY,path:drawPath.points})}checkHits();draw();updateUI()});canvas.addEventListener('mouseleave',()=>{if(drawing){drawing=false;if(drawPath.points.length>5)state.p1.marks.push({x:tapX,y:tapY,path:drawPath.points});checkHits();draw();updateUI()}});function checkHits(){state.p1.marks.forEach(m=>{state.drops.forEach(d=>{if(!d.hit){const dist=Math.hypot(m.x-d.x,m.y-d.y);if(dist<d.r+10){d.hit=true;state.p1.hits++;state.p1.score+=Math.round(100*d.conf)}}})});updateUI()}function aiTurn(){if(!state.gameRunning||state.gamePaused)return;const mod={easy:{acc:0.5,spd:800},medium:{acc:0.7,spd:600},hard:{acc:0.85,spd:400},expert:{acc:0.95,spd:200}}[state.difficulty];if(Math.random()<mod.acc){const d=state.drops.find(x=>!x.hit);if(d){d.hit=true;state.p2.hits++;state.p2.score+=Math.round(100*d.conf)}}setTimeout(aiTurn,Math.random()*mod.spd+mod.spd)}function updateUI(){document.getElementById('p1-score').textContent=state.p1.score;document.getElementById('p1-hits').textContent=state.p1.hits;document.getElementById('p1-marks').textContent=state.p1.marks.length;document.getElementById('p2-score').textContent=state.p2.score;document.getElementById('p2-hits').textContent=state.p2.hits;document.getElementById('ai-score').textContent=state.ai.score;document.getElementById('ai-hits').textContent=state.drops.filter(d=>d.hit).length;document.getElementById('fps').textContent=`FPS: ${state.fps}`;document.getElementById('detect-time').textContent=`Detect: ${state.detectTime}ms`;document.getElementById('drops').textContent=`Drops: ${state.drops.length}`;const sec=Math.ceil(Math.max(0,state.timeRemaining)/1000);document.getElementById('timer').textContent=sec;if(sec===0&&state.gameRunning)endGame()}function endGame(){state.gameRunning=false;const scores={YOU:state.p1.score,CPU:state.p2.score,AI:state.ai.score};const winner=Object.keys(scores).reduce((a,b)=>scores[a]>scores[b]?a:b);alert(`GAME OVER!\n${winner} WINS!\n\nYOU: ${state.p1.score}\nCPU: ${state.p2.score}\nAI: ${state.ai.score}`)}function gameLoop(){if(!state.gameRunning||state.gamePaused)return;const now=Date.now();state.timeRemaining=GAME_TIME-(now-state.gameStartTime);if(state.timeRemaining<=0){state.timeRemaining=0;endGame();return}state.detectFrame++;if(state.detectFrame>=DETECT_INTERVAL&&state.detecting&&video.readyState===video.HAVE_ENOUGH_DATA){const t0=performance.now();state.drops=findDrops(ctx.getImageData(0,0,canvas.width,canvas.height));state.detectTime=Math.round(performance.now()-t0);state.detectFrame=0}state.frameCount++;if(now-state.lastFpsTime>=1000){state.fps=state.frameCount;state.frameCount=0;state.lastFpsTime=now}draw();updateUI();aiTurn();requestAnimationFrame(gameLoop)}loadVideo();updateUI();document.getElementById('difficulty').addEventListener('change',e=>state.difficulty=e.target.value)</script></body></html>
